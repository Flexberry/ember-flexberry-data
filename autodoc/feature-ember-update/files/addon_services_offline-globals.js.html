<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>addon/services/offline-globals.js - Flexberry Documentation</title>
    <link rel="stylesheet" href="">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="stylesheet" href="../assets/css/custom.css">
    <link rel="stylesheet" href="../assets/vendor/bootstrap/css/bootstrap.css">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
</head>
<body class="yui3-skin-sam">
<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <h1 class="brand" style="padding: 10px 16px 10px; height: 20px; line-height: 20px; margin-left: 0;">
	    <img alt="Flexberry Documentation" src="../assets/css/logo.png" style="max-height: 65%;" title="Flexberry Documentation">
            Flexberry Documentation
        </h1>
	<div class="nav">
            <li class="divider-vertical"></li>
            <li>
                <p class="navbar-text">
                    API Docs for Version: <b>master</b>
                </p>
            </li>
        </div>
        <form class="navbar-form pull-right" style="line-height: 40px; height: 40px;">
            <input style="margin-top: 0;" type="text" class="search-query" placeholder="Search for classes/modules..." data-obj='["classes/AdapterMixin", "classes/ApplicationInitializer", "classes/Base", "classes/BaseAdapter", "classes/BaseBuilder", "classes/BasePredicate", "classes/Builder", "classes/ComplexPredicate", "classes/Condition", "classes/CopyableMixin", "classes/DatePredicate", "classes/DecimalTransform", "classes/DexieService", "classes/FileTransform", "classes/FilterOperator", "classes/FlexberryEnumTransform", "classes/GlobalsService", "classes/GuidTransform", "classes/IndexedDBAdapter", "classes/Information", "classes/JsAdapter", "classes/LocalStore", "classes/Model", "classes/ModelMixin", "classes/OData", "classes/OData.OnlineStore", "classes/ODataAdapter", "classes/Offline", "classes/OrderByClause", "classes/Projection", "classes/Query.Condition", "classes/Query.DetailPredicate", "classes/Query.FilterOperator", "classes/Query.GeographyPredicate", "classes/Query.GeometryPredicate", "classes/Query.IsOfPredicate", "classes/Query.NotPredicate", "classes/Query.OrderByClause", "classes/QueryObject", "classes/SimplePredicate", "classes/Store", "classes/StoreMixin", "classes/StringPredicate", "classes/Syncer", "modules/ember-flexberry", "modules/ember-flexberry-data"]'>
        </form>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="span3">
	    <div>
	        <h3>APIs</h3>
	        <div id="sidebar">
	            <ul id="main-nav" class="nav nav-tabs" style="margin-bottom:0;">
	                <li class="active"><a href="#classes" data-toggle="tab">Classes</a></li>
	                <li><a href="#modules" data-toggle="tab">Modules</a></li>
	            </ul>
	    
	            <div id="api-tabview-filter">
	                <input type="search" placeholder="Type to filter APIs">
	            </div>
	    
	            <div class="tab-content" style="border: 1px solid #DDD; border-top:0;">
	                <div class="tab-pane active" id="classes">
	                    <ul id="api-classes" class="nav nav-list">
	                            <li><a href="../classes/AdapterMixin.html">AdapterMixin</a></li>
	                            <li><a href="../classes/ApplicationInitializer.html">ApplicationInitializer</a></li>
	                            <li><a href="../classes/Base.html">Base</a></li>
	                            <li><a href="../classes/BaseAdapter.html">BaseAdapter</a></li>
	                            <li><a href="../classes/BaseBuilder.html">BaseBuilder</a></li>
	                            <li><a href="../classes/BasePredicate.html">BasePredicate</a></li>
	                            <li><a href="../classes/Builder.html">Builder</a></li>
	                            <li><a href="../classes/ComplexPredicate.html">ComplexPredicate</a></li>
	                            <li><a href="../classes/Condition.html">Condition</a></li>
	                            <li><a href="../classes/CopyableMixin.html">CopyableMixin</a></li>
	                            <li><a href="../classes/DatePredicate.html">DatePredicate</a></li>
	                            <li><a href="../classes/DecimalTransform.html">DecimalTransform</a></li>
	                            <li><a href="../classes/DexieService.html">DexieService</a></li>
	                            <li><a href="../classes/FileTransform.html">FileTransform</a></li>
	                            <li><a href="../classes/FilterOperator.html">FilterOperator</a></li>
	                            <li><a href="../classes/FlexberryEnumTransform.html">FlexberryEnumTransform</a></li>
	                            <li><a href="../classes/GlobalsService.html">GlobalsService</a></li>
	                            <li><a href="../classes/GuidTransform.html">GuidTransform</a></li>
	                            <li><a href="../classes/IndexedDBAdapter.html">IndexedDBAdapter</a></li>
	                            <li><a href="../classes/Information.html">Information</a></li>
	                            <li><a href="../classes/JsAdapter.html">JsAdapter</a></li>
	                            <li><a href="../classes/Model.html">Model</a></li>
	                            <li><a href="../classes/ModelMixin.html">ModelMixin</a></li>
	                            <li><a href="../classes/OData.html">OData</a></li>
	                            <li><a href="../classes/ODataAdapter.html">ODataAdapter</a></li>
	                            <li><a href="../classes/Offline.html">Offline</a></li>
	                            <li><a href="../classes/OrderByClause.html">OrderByClause</a></li>
	                            <li><a href="../classes/Projection.html">Projection</a></li>
	                            <li><a href="../classes/Query.Condition.html">Query.Condition</a></li>
	                            <li><a href="../classes/Query.DetailPredicate.html">Query.DetailPredicate</a></li>
	                            <li><a href="../classes/Query.FilterOperator.html">Query.FilterOperator</a></li>
	                            <li><a href="../classes/Query.GeographyPredicate.html">Query.GeographyPredicate</a></li>
	                            <li><a href="../classes/Query.GeometryPredicate.html">Query.GeometryPredicate</a></li>
	                            <li><a href="../classes/Query.IsOfPredicate.html">Query.IsOfPredicate</a></li>
	                            <li><a href="../classes/Query.NotPredicate.html">Query.NotPredicate</a></li>
	                            <li><a href="../classes/Query.OrderByClause.html">Query.OrderByClause</a></li>
	                            <li><a href="../classes/QueryObject.html">QueryObject</a></li>
	                            <li><a href="../classes/SimplePredicate.html">SimplePredicate</a></li>
	                            <li><a href="../classes/Store.html">Store</a></li>
	                            <li><a href="../classes/StoreMixin.html">StoreMixin</a></li>
	                            <li><a href="../classes/StringPredicate.html">StringPredicate</a></li>
	                            <li><a href="../classes/Syncer.html">Syncer</a></li>
	                    </ul>
	                </div>
	    
	                <div class="tab-pane" id="modules">
	                    <ul id="api-modules" class="nav nav-list">
	                            <li><a href="../modules/ember-flexberry.html">ember-flexberry</a></li>
	                            <li><a href="../modules/ember-flexberry-data.html">ember-flexberry-data</a></li>
	                    </ul>
	                </div>
	            </div>
	        </div>
	    </div>
        </div>
        <div class="span9">
                <form id="options-form" class="form-inline pull-right">
                    Show:
                    <label for="api-show-inherited" class="checkbox">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected" class="checkbox">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private" class="checkbox">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated" class="checkbox">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </form>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<div class="page-header">
    <h1>addon/services/offline-globals.js <small>File</small></h1>
</div>

<div class="file">
    <pre class="prettyprint linenums">
import Evented from &#x27;@ember/object/evented&#x27;;
import Service from &#x27;@ember/service&#x27;;
import { getOwner } from &#x27;@ember/application&#x27;;
import { isNone } from &#x27;@ember/utils&#x27;;

/**
  @module ember-flexberry-data
*/

/**
  Service for operate with global online and offline properties and events.

  @class GlobalsService
  @extends Ember.Service
  @public
*/
export default Service.extend(Evented, {
  /**
    Availability of the backend.
    @property isOnline
    @type Boolean
    @default false
    @readOnly
  */
  isOnline: false,

  /**
    Possibility of using offline storage.
    Gets from application config.
    @property isOfflineEnabled
    @type Boolean
    @default true
    @readOnly
  */
  isOfflineEnabled: true,

  /**
    If true then perform switch to offline mode when got online connection errors.
    Gets from application config.
    @property isModeSwitchOnErrorsEnabled
    @type Boolean
    @default false
    @readOnly
  */
  isModeSwitchOnErrorsEnabled: false,

  /**
    If true then all work with records will sync down when online.
    This let user to continue work without online connection.
    Gets from application config.
    @property isSyncDownWhenOnlineEnabled
    @type Boolean
    @default true
    @readOnly
  */
  isSyncDownWhenOnlineEnabled: true,

  /**
    If true then record will be synced down completely, i.e. including with all related records with arbitrary nesting.
    Otherwise only requested record will be synced down without related records.
    If set to true then it may cause errors in case of loops are present in model structure.
    Gets from application config.
    @property allowSyncDownRelatedRecordsWithoutProjection
    @type Boolean
    @default false
    @readOnly
  */
  allowSyncDownRelatedRecordsWithoutProjection: false,

  /**
    Trigger for &quot;online is available&quot; or &quot;online is unavailable&quot; event.
    Event name: online/offline.

    @method setOnlineAvailable

    @param {Boolean} isOnline Availability of online to set.
  */
  setOnlineAvailable(isOnline) {
    this.set(&#x27;isOnline&#x27;, isOnline);
    let eventName = isOnline ? &#x27;online&#x27; : &#x27;offline&#x27;;
    this.trigger(eventName);
  },

  /**
    Get online status.
    Always returns &#x27;true&#x27; by default.
    Needs for overload when using on mobile devices.

    @method checkOnlineAvailable

    @return {Boolean} Returns online status on current device.
  */
  checkOnlineAvailable() {
    return true;
  },

  /*
    Service initialization.
  */
  init() {
    this._super(...arguments);
    let app = getOwner(this).application;

    if (app.offline) {
      //Reading offline settings from application seetings in &#x60;environment.js&#x60;.
      this._setOption(&#x27;isOfflineEnabled&#x27;, app.offline.offlineEnabled ? true : false);
      this._setOption(&#x27;isModeSwitchOnErrorsEnabled&#x27;, app.offline.modeSwitchOnErrorsEnabled ? true : false);
      this._setOption(&#x27;isSyncDownWhenOnlineEnabled&#x27;, app.offline.syncDownWhenOnlineEnabled ? true : false);
      this._setOption(&#x27;allowSyncDownRelatedRecordsWithoutProjection&#x27;, app.offline.allowSyncDownRelatedRecordsWithoutProjection ? true : false);
    }

    //Detect availability of online connection at start of application.
    let isOnlineAvailable = this.checkOnlineAvailable();
    this.setOnlineAvailable(isOnlineAvailable);
  },

  /**
    Get offline schema.

    @method getOfflineSchema

    @return {Object} Returns offline schema.
  */
  getOfflineSchema() {
    return {
      &#x27;i-c-s-soft-s-t-o-r-m-n-e-t-business-audit-objects-audit-entity&#x27;:
        &#x27;id,objectPrimaryKey,operationTime,operationType,executionResult,source,serializedField,&#x27; +
        &#x27;createTime,creator,editTime,editor,user,objectType,*auditFields&#x27;,
      &#x27;i-c-s-soft-s-t-o-r-m-n-e-t-business-audit-objects-audit-field&#x27;:
        &#x27;id,field,caption,oldValue,newValue,mainChange,auditEntity&#x27;,
      &#x27;i-c-s-soft-s-t-o-r-m-n-e-t-business-audit-objects-object-type&#x27;:
        &#x27;id,name&#x27;,
      &#x27;i-c-s-soft-s-t-o-r-m-n-e-t-security-agent&#x27;:
        &#x27;id,name,login,pwd,isUser,isGroup,isRole,connString,enabled,email,full,read,insert,update,&#x27; +
        &#x27;delete,execute,createTime,creator,editTime,editor&#x27;,
      &#x27;i-c-s-soft-s-t-o-r-m-n-e-t-security-link-group&#x27;:
        &#x27;id,createTime,creator,editTime,editor,group,user&#x27;,
      &#x27;i-c-s-soft-s-t-o-r-m-n-e-t-security-session&#x27;:
        &#x27;id,userKey,startedAt,lastAccess,closed&#x27;,
    };
  },

  /*
    Helper method for setting class properties with offline options.
  */
  _setOption: function(optionName, optionValue) {
    if (!isNone(optionValue)) {
      this.set(optionName, optionValue);
    }
  }
});

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/jquery/jquery-1.8.2.min.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap.js"></script>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script src="../assets/js/yuidoc-bootstrap.js"></script>
<script>prettyPrint();</script>
</body>
</html>
